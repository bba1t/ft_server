

#### /etc/nginx/ - КОНФИГУРАЦИЯ ("мозг" системы)

Тут лежат все конфиги, которые дальше обращаются к папке /var/
```
/etc/nginx/
├── nginx.conf                    # ⚡ ГЛАВНЫЙ конфиг-файл
│   # Содержит основные настройки: пользователь, рабочие процессы, логирование
│   # Подключает остальные конфиги через include директивы
├── sites-available/              # 📚 БИБЛИОТЕКА доступных конфигов
│   ├── default                  # Конфиг по умолчанию (шаблон)
│   ├── wordpress.conf           # Ваш конфиг для WordPress
│   └── phpmyadmin.conf          # Конфиг для phpMyAdmin
├── sites-enabled/               # 🚀 ЗАПУЩЕННЫЕ сайты
│   ├── default -> ../sites-available/default
│   └── wordpress -> ../sites-available/wordpress.conf
├── conf.d/                      # 🔧 Дополнительные настройки
│   ├── ssl.conf                 # Настройки SSL
│   └── gzip.conf                # Сжатие GZIP
├── modules-available/           # 📦 Доступные модули
├── modules-enabled/             # ✅ Активированные модули
├── snippets/                    # 🧩 Переиспользуемые блоки
│   ├── ssl-params.conf
│   └── security-headers.conf
└── mime.types                   # 📄 Соответствие MIME-типов
```

Дополнительно
```
/etc/
├── nginx/                      # 🌐 NGINX
│   ├── nginx.conf             # ⚙️ ГЛАВНЫЙ КОНФИГ
│   ├── sites-available/       # 🏠 Конфиги сайтов
│   └── sites-enabled/         # ✅ Активные сайты
├── mysql/                      # 🗄️ MYSQL
│   ├── my.cnf                 # ⚙️ ГЛАВНЫЙ КОНФИГ
│   ├── conf.d/                # 📁 Дополнительные конфиги
│   └── mariadb.conf.d/        # 🔧 Конфиги MariaDB
├── php/                        # 🐘 PHP
│   ├── php.ini                # ⚙️ ГЛАВНЫЙ КОНФИГ PHP
│   └── fpm/                   # 🚀 Конфиги PHP-FPM
└── apache2/                   # 🌐 APACHE (если бы использовали)
    └── apache2.conf          # ⚙️ ГЛАВНЫЙ КОНФИГ
```
#####  sites-available vs sites-enabled

Nginx видит только симлинки в `sites-enabled/` и загружает конфиги, на которые они указывают. Это система "включения/выключения" сайтов без удаления конфигов.

В главном конфиге `nginx.conf` есть строка:
```nginx
http {
    # Nginx загружает ВСЕ файлы из sites-enabled
    include /etc/nginx/sites-enabled/*;
}
```


Альтернатива: директория conf.d/
```text
/etc/nginx/conf.d/
├── wordpress.conf
└── phpmyadmin.conf
```

Разница:
- `conf.d/` - просто копируете `.conf` файлы, они автоматически загружаются
- `sites-available/enabled` - более продвинутая система с симлинками

#### /var/ - рабочая зона, ДАННЫЕ которые могут меняться в процессе работы

```
/var/
├── www/                         # 🌐 ВЕБ-САЙТЫ (самое важное для вас!)
│   ├── html/                    # Документ root по умолчанию
│   │   └── index.html          # Стандартная страница "Welcome to nginx"
│   ├── wordpress/               # 🏠 ВАШ WordPress
│   │   ├── index.php
│   │   ├── wp-config.php       # Конфиг WordPress (БД, ключи)
│   │   ├── wp-content/         # Темы, плагины, загрузки
│   │   │   ├── themes/
│   │   │   ├── plugins/
│   │   │   └── uploads/        # 💾 Папка для загрузок (нужны права записи!)
│   │   └── wp-admin/
│   ├── phpmyadmin/              # 📊 Базы данных
│   │   ├── index.php
│   │   └── config.inc.php      # Конфиг phpMyAdmin
│   └── logs/                    # Логи конкретных сайтов
├── log/                         # 📋 СИСТЕМНЫЕ ЛОГИ
│   └── nginx/
│       ├── access.log           # 🎯 Кто и когда заходил
│       ├── error.log            # ❌ Ошибки и предупреждения
│       ├── wordpress.access.log
│       └── phpmyadmin.error.log
│── lib/                         # 🗄️ ДАННЫЕ ПРИЛОЖЕНИЙ
│    └── mysql/                   # Базы данных MySQL
│        ├── ibdata1             # Основной файл данных
│        └── wordpress/          # База данных WordPress
├── run/                         # 🏃‍♂️ RUNTIME ДАННЫЕ ПРОЦЕССОВ (ВРЕМЕННЫЕ)
│   ├── mysqld/                  # 🗄️ MariaDB/MySQL
│   │   ├── mysqld.pid          # 📍 ID процесса MySQL
│   │   └── mysqld.sock         # 🔌 Сокет для подключения к MySQL
│   ├── php/                     # 🐘 PHP-FPM
│   │   └── php7.3-fpm.sock     # 🔌 Сокет для подключения к PHP-FPM
│   ├── nginx.pid                # 📍 ID процесса Nginx
│   └── php7.3-fpm.pid          # 📍 ID процесса PHP-FPM
```

Важность прав доступа в /var/www/:
```bash
# WordPress должен иметь право записывать в wp-content/uploads/
chown -R www-data:www-data /var/www/wordpress/wp-content/
chmod -R 755 /var/www/wordpress/wp-content/uploads/
```


##### /var/run/

Если `/var/lib/` - это **"долговременная память"** (базы данных, файлы), то `/var/run/` - это **"оперативная память"** для работающих процессов.

Почему именно `/var/run/`:
1. Временый характер данных
	- Данные в `/var/run/` существуют **только во время работы процесса**
	- При перезагрузке системы папка **очищается автоматически**
	- Это **не данные для сохранения**, а временные файлы для коммуникации

2. Быстрый доступ
	- Обычно размещается в **оперативной памяти** (tmpfs)
	- **Очень высокая скорость** чтения/записи
	- Идеально для частой коммуникации между процессами
	
3. Это "комнаты переговоров" где процессы общаются друг с другом через:
	- **🔌 Сокеты** - для межпроцессного взаимодействия
	- **📍 PID-файлы** - для управления процессами
	- **🔒 Lock-файлы** - для предотвращения конфликтов

4. Без правильной настройки `/var/run/`:
	- Nginx не сможет подключиться к PHP-FPM
	- MySQL клиенты не смогут подключиться к серверу
	- Скрипты не смогут управлять процессами

В современных Linux-системах `/var/run/` является **симлинком** на `/run/`, а иногда наоборот.
- **Раньше:** Только `/var/run/`
- **Сейчас:** `/run/` (корневой уровень) → симлинк → `/var/run/`
- **Причина:** Некоторые системные процессы должны стартовать ОЧЕНЬ рано, до того как `/var/` будет смонтирован.


##### /lib/ vs /var/lib/

|Характеристика|`/lib/`|`/var/lib/`|
|---|---|---|
|**Назначение**|Системные библиотеки|Данные приложений|
|**Изменяемость**|Read-only (почти)|Read-write (постоянно)|
|**Содержимое**|.so файлы, модули|Базы данных, кэш, состояния|
|**Аналогия**|Программные библиотеки|Файлы сохранений игр|

```text
/lib/
├── systemd/                    # 🚀 Модули systemd
├── apt/                        # 📦 Модули пакетного менеджера
├── modules/                    # 🔧 Загружаемые модули ядра
│   └── ...
├── lsb/                        # 🐧 Linux Standard Base
└── *.*.so*                    # 📚 Библиотеки (.so файлы)
```

```text
/var/lib/
├── mysql/                        # 🗄️ Базы данных MySQL
│   ├── ibdata1                  # Основной файл данных
│   ├── ib_logfile0              # Лог-файлы InnoDB
│   └── wordpress/               # Данные WordPress БД
├── apt/                         # 📦 Кэш и состояния apt
│   ├── lists/                   # Списки пакетов
│   └── status                   # Статусы пакетов
├── dpkg/                        # 🖥️ Информация об установленных пакетах
├── nginx/                       # 🌐 Данные Nginx (если есть)
│   └── body/                    # Тела запросов при прокси
└── php/                         # 🐘 Сессии и данные PHP
    └── sessions/                # Файлы сессий PHP
```